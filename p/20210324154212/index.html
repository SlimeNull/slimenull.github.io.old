<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='PowerShell 快速入门开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.此文章对于 .NET 开发者来说更简单哦!在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.0. 官方文档既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文'><title>[PowerShell] 快速入门, 基本语法, 常用类型, 函数, .NET 互操作</title>
<link rel=canonical href=https://slimenull.com/p/20210324154212/><link rel=stylesheet href=/scss/style.min.73438a911857e6d491e39369614d0dd0c0302dcacfb43e15034e0e48cac08c07.css><meta property='og:title' content='[PowerShell] 快速入门, 基本语法, 常用类型, 函数, .NET 互操作'><meta property='og:description' content='PowerShell 快速入门开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.此文章对于 .NET 开发者来说更简单哦!在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.0. 官方文档既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文'><meta property='og:url' content='https://slimenull.com/p/20210324154212/'><meta property='og:site_name' content='SlimeNull Blogs'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='powershell'><meta property='article:tag' content='脚本语言'><meta property='article:tag' content='dotnet'><meta property='article:published_time' content='2021-03-24T15:42:12+08:00'><meta property='article:modified_time' content='2021-03-24T15:42:12+08:00'><meta name=twitter:title content="[PowerShell] 快速入门, 基本语法, 常用类型, 函数, .NET 互操作"><meta name=twitter:description content="PowerShell 快速入门开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.此文章对于 .NET 开发者来说更简单哦!在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.0. 官方文档既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu11436448765783238083.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>SlimeNull Blogs</a></h1><h2 class=site-description>为了更好的开源世界~</h2></div></header><ol class=social-menu><li><a href=https://github.com/SlimeNull target=_blank title=GitHub rel=me><!doctype html><svg t="1702542119184" class="icon" viewBox="0 0 1024 1024" p-id="4136" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M692.906667 938.666667A42.666667 42.666667.0 01650.24 896V785.066667A91.733333 91.733333.0 00627.2 714.24a42.666667 42.666667.0 0126.026667-71.253333c104.106666-12.373334 200.106666-45.653334 200.106666-226.133334a170.666667 170.666667.0 00-28.586666-94.72A117.333333 117.333333.0 01807.253333 234.24a158.293333 158.293333.0 000-60.16A326.4 326.4.0 00718.08 220.586667a42.666667 42.666667.0 01-35.84 6.4 433.066667 433.066667.0 00-235.52.0 42.666667 42.666667.0 01-35.84-6.4A315.733333 315.733333.0 00320.853333 174.08a150.186667 150.186667.0 000 60.16 121.173333 121.173333.0 01-18.346666 88.746667A173.653333 173.653333.0 00273.92 418.133333C273.92 584.106666 354.133333 628.48 474.453333 643.84A42.666667 42.666667.0 01509.44 672a42.666667 42.666667.0 01-8.96 42.666667 87.893333 87.893333.0 00-23.466667 66.56V896A42.666667 42.666667.0 01391.68 896v-24.32a256 256 0 01-224.853333-89.173333A166.4 166.4.0 00117.333333 744.96a42.666667 42.666667.0 1121.333334-82.773333A210.346667 210.346667.0 01224 720.213333c42.666667 42.666667 85.333333 80.213333 166.4 64.853334a165.973333 165.973333.0 019.813333-67.413334C312.32 695.466666 186.88 632.32 186.88 418.986667a256 256 0 0142.666667-142.08 36.266667 36.266667.0 005.546666-26.453334 242.773333 242.773333.0 0114.08-136.96 42.666667 42.666667.0 0126.88-24.32c14.506667-4.266667 66.56-12.8 165.12 51.2a518.826667 518.826667.0 01242.773334.0c98.56-64 150.613333-55.893333 164.693333-51.2a42.666667 42.666667.0 0126.88 24.32A243.626667 243.626667.0 01889.6 250.88a32 32 0 004.693333 24.32A256 256 0 01936.96 417.706667c0 216.32-124.586667 279.04-213.333333 298.666666a182.613333 182.613333.0 019.386666 71.253334V896a42.666667 42.666667.0 01-40.106666 42.666667z" fill="#666" p-id="4137"/></svg></a></li><li><a href=https://space.bilibili.com/441842015 target=_blank title=Bilibili rel=me><!doctype html><svg t="1702541966104" class="icon" viewBox="0 0 1024 1024" p-id="16981" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632 444.330667 256h135.296l138.368-138.325333A42.666667 42.666667.0 01778.368 178.048L700.330667 256H789.333333A149.333333 149.333333.0 01938.666667 405.333333v341.333334A149.333333 149.333333.0 01789.333333 896H234.666667A149.333333 149.333333.0 0185.333333 746.666667V405.333333A149.333333 149.333333.0 01234.666667 256h88.96L245.632 177.962667a42.666667 42.666667.0 0160.373333-60.373334zm483.328 223.701333H234.666667a64 64 0 00-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0057.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0063.701334-57.856L853.333333 746.666667V405.333333a64 64 0 00-64-64zm-448 128A42.666667 42.666667.0 01384 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666666-42.666667zm341.333334.0A42.666667 42.666667.0 01725.333333 512v85.333333a42.666667 42.666667.0 01-85.333333.0V512a42.666667 42.666667.0 0142.666667-42.666667z" fill="#666" p-id="16982"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://slimenull.com/ selected></option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#0-准备工作>0. 准备工作</a><ol><li><a href=#--官方文档>- 官方文档</a></li><li><a href=#--启动-powershell>- 启动 PowerShell</a></li></ol></li><li><a href=#1-基本语法>1. 基本语法</a><ol><li><a href=#--标准输出>- 标准输出</a></li><li><a href=#--获取帮助>- 获取帮助:</a></li><li><a href=#--定义变量>- 定义变量</a></li><li><a href=#--固定常量>- 固定常量</a></li><li><a href=#--类型概念>- 类型概念</a></li><li><a href=#--表达式与指令>- 表达式与指令</a></li><li><a href=#--运算符>- 运算符</a></li></ol></li><li><a href=#2-流程控制>2. 流程控制:</a><ol><li><a href=#--基本判断>- 基本判断</a></li><li><a href=#--循环语句>- 循环语句</a></li></ol></li><li><a href=#3-常用类型>3. 常用类型</a><ol><li><a href=#--对象数组>- 对象数组</a></li><li><a href=#--哈希表>- 哈希表</a></li></ol></li><li><a href=#4-脚本函数>4. 脚本函数</a><ol><li><a href=#--关于函数>- 关于函数</a></li></ol></li><li><a href=#5-面向对象>5. 面向对象</a><ol><li><a href=#--使用对象>- 使用对象</a></li><li><a href=#--net-互操作>- .NET 互操作</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/dotnet/ style=background-color:#512cd4;color:#fff>.NET
</a><a href=/categories/note/ style=background-color:#fdf0c4;color:#3d3d3d>笔记</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/20210324154212/>[PowerShell] 快速入门, 基本语法, 常用类型, 函数, .NET 互操作</a></h2><h3 class=article-subtitle>PowerShell 快速入门开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.此文章对于 .NET 开发者来说更简单哦!在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.0. 官方文档既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 24, 2021</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 9 分钟</time></div></footer></div></header><section class=article-content><h1 id=powershell-快速入门>PowerShell 快速入门</h1><blockquote><p>开始之前, 我们认定你已经有一定的编程基础, 熟悉 .NET 中的类型与对象.</p><p>此文章对于 .NET 开发者来说更简单哦!</p></blockquote><p>在 PowerShell 中, 几乎一切都是对象. 与 CMD 有很大不同. PowerShell 是强类型的, 它基于 .NET, 故, PowerShell 可以近乎完美的调用 .NET 的标准库.</p><h2 id=0-准备工作>0. 准备工作</h2><h3 id=--官方文档>- 官方文档</h3><p>既然要学新东西, 肯定要会查阅官方文档才彳亍呀! 本文章参阅官方文档, 并使用更简单的语言讲述给读者, 在每一部分都会有推荐的官方文档链接目录, 点击即可跳转.</p><blockquote><p><a class=link href="https://docs.microsoft.com/en-us/powershell/scripting/how-to-use-docs?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 如何使用 PowerShell 官方文档</a></p><p><a class=link href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : PowerShell 是什么</a></p><p><a class=link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于主题 (涵盖有关 PowerShell 的一系列概念)</a></p></blockquote><p>另外, 在文档的中文页面的左侧索引部分, 你无法看到所有的内容, 例如 Reference 分类, 其中包含了非常多的 &lsquo;隐藏&rsquo; 内容, 只有你切换到英文页面才可以看到它们.</p><p>至于如何切换页面语言, 也简单, 只需要将地址栏中的 &lsquo;zh-cn&rsquo; 改为 &rsquo;en-us&rsquo; 即可, 同理, 如果某个页面你看不懂, 想要切换到中文, 可以将 &rsquo;en-us&rsquo; 改为 &lsquo;zh-cn&rsquo;, 不过需要注意的是, 部分页面是没有提供中文翻译的.</p><p>为了方便, 本文涉及到的所有文档链接均为英文直链, 如需访问中文页面, 请自行修改链接地址.</p><h3 id=--启动-powershell>- 启动 PowerShell</h3><p>PowerShell 同 CMD 一样有许多启动方式, 准备好开始了吗? 那么开始吧!</p><ol><li><p>按下 &ldquo;Win&rdquo; + &ldquo;R&rdquo; 打开 &lsquo;运行&rsquo; 窗口, 键入 &lsquo;PowerShell&rsquo; 并确认.</p></li><li><p>按 &ldquo;Win&rdquo; + X, 然后按 &lsquo;I&rsquo;, 或者按 &lsquo;A&rsquo;(以管理员身份运行).</p></li><li><p>在桌面或资源管理器, 不选中任何条目, 按住 Shift, 右击背景, 在弹出的菜单中选择 &lsquo;在此处启动 PowerShell&rsquo;.</p></li><li><p>在资源管理器中, 在地址栏输入 &lsquo;PowerShell&rsquo; 并按 Enter 键确认.</p></li></ol><p>接下来, 出现的蓝底白字的控制台页面就是 PowerShell 的主程序了! 在其中输入指令(代码)可以运行一些东西.</p><h2 id=1-基本语法>1. 基本语法</h2><h3 id=--标准输出>- 标准输出</h3><p>让我们从一个 &lsquo;hello world&rsquo; 的输出开始吧, 与 CMD, Bash 一样, 使用 echo 指令是可以输出内容的.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>echo </span><span class=s2>&#34;Hello World!&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Hello World!
</span></span></code></pre></td></tr></table></div></div><h3 id=--获取帮助>- 获取帮助:</h3><p>执行以下指令来获取关于 echo 的帮助内容.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-Help</span> <span class=nb>echo
</span></span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>NAME
</span></span><span class=line><span class=cl>    Write-Output
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SYNTAX
</span></span><span class=line><span class=cl>    Write-Output [-InputObject] &lt;psobject[]&gt; [-NoEnumerate]  [&lt;CommonParameters&gt;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ALIASES
</span></span><span class=line><span class=cl>    write
</span></span><span class=line><span class=cl>    echo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>REMARKS
</span></span><span class=line><span class=cl>    Get-Help cannot find the Help files for this cmdlet on this computer. It is displaying only partial help.
</span></span><span class=line><span class=cl>        -- To download and install Help files for the module that includes this cmdlet, use Update-Help.
</span></span><span class=line><span class=cl>        -- To view the Help topic for this cmdlet online, type: &#34;Get-Help Write-Output -Online&#34; or
</span></span><span class=line><span class=cl>           go to https://go.microsoft.com/fwlink/?LinkID=113427.     
</span></span></code></pre></td></tr></table></div></div><p>看到结果, 你懂了吧, echo 实际上是 Write-Output 的别名, 同时也可以用 write 来执行.</p><p>另外, PowerShell 的指令是不区分大小写的, 所以 Write-Output 与 wRITE-oUTPUT 是一样执行效果的</p><h3 id=--定义变量>- 定义变量</h3><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_variables target=_blank rel=noopener>PowerShell 官方文档 : 关于变量</a></p></blockquote><p>定义变量的方式与 Bash 差不多, 都是用 $ 开头, 后跟变量名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$var</span> <span class=p>=</span> <span class=mf>123</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$var</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>123
</span></span></code></pre></td></tr></table></div></div><h3 id=--固定常量>- 固定常量</h3><p>PowerShell 中有一些常量, 不可被赋值 (如果对其赋值, 不会产生任何作用, 且不会抛出异常)</p><div class=table-wrapper><table><thead><tr><th>常量名</th><th>类型</th><th>值</th></tr></thead><tbody><tr><td>$null</td><td>object</td><td>null</td></tr><tr><td>$true</td><td>bool</td><td>true</td></tr><tr><td>$false</td><td>bool</td><td>false</td></tr></tbody></table></div><p>如果访问一些未定义的变量, 返回的值同样是 null</p><h3 id=--类型概念>- 类型概念</h3><p>PowerShell 是强类型的. 例如刚刚我们定义的变量, 其实就是一个 int 变量. 示例:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$a</span> <span class=p>=</span> <span class=mf>123</span>
</span></span><span class=line><span class=cl><span class=nv>$b</span> <span class=p>=</span> <span class=mf>321</span>
</span></span><span class=line><span class=cl><span class=nv>$c</span> <span class=p>=</span> <span class=nv>$a</span> <span class=p>+</span> <span class=nv>$b</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$c</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>444
</span></span></code></pre></td></tr></table></div></div><p>数字支持运算, 所以理所当然的可以进行运算.</p><h3 id=--表达式与指令>- 表达式与指令</h3><p>刚刚我们所用的 echo 指令, 同时可以说是一个表达式. 而刚刚我们进行加法运算时, 所使用的 &lsquo;$a + $b&rsquo; 通用</p><p>我没猜错的话, 在刚刚的变量部分, 也同样有人这么执行:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$a</span> <span class=p>=</span> <span class=mf>123</span>
</span></span><span class=line><span class=cl><span class=nv>$b</span> <span class=p>=</span> <span class=mf>321</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$a</span> <span class=p>+</span> <span class=nv>$b</span>
</span></span></code></pre></td></tr></table></div></div><p>然后结果就是, 输出了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>$a + $b
</span></span></code></pre></td></tr></table></div></div><p>而解决办法就是, 为这个表达式加上括号, 优先运算这个表达式, 于是就正常了, 或者你可以直接 echo 一个表达式:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>echo </span><span class=p>(</span><span class=mf>123</span><span class=p>+</span><span class=mf>321</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>输出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>444
</span></span></code></pre></td></tr></table></div></div><h3 id=--运算符>- 运算符</h3><p>刚刚我们从尝试了加法运算, 同时在 PowerShell 中, 也是支持减法, 乘法, 除法的, 除此之外还有小于, 大于, 等于, 大于等于, 小于等于:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>echo </span><span class=p>(</span><span class=mf>1</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>True
</span></span></code></pre></td></tr></table></div></div><div class=table-wrapper><table><thead><tr><th>运算符</th><th>描述</th></tr></thead><tbody><tr><td>-eq</td><td>等于</td></tr><tr><td>-ne</td><td>不等于</td></tr><tr><td>-lt</td><td>小于</td></tr><tr><td>-gt</td><td>大于</td></tr><tr><td>-le</td><td>小于等于</td></tr><tr><td>-ge</td><td>大于等于</td></tr></tbody></table></div><h2 id=2-流程控制>2. 流程控制:</h2><h3 id=--基本判断>- 基本判断</h3><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_if target=_blank rel=noopener>MSDocs PowerShell : 关于 If</a></p></blockquote><p>判断的话, 毋庸置疑是 if 语句. 当然, 无非是 &lsquo;if&rsquo; &rsquo;else&rsquo; &rsquo;else if&rsquo;</p><p>在 PowerShell 中, if 语句的语法可以是这样:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>exp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>elseif</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$randint</span> <span class=p>=</span> <span class=p>(</span><span class=nb>New-Object</span> <span class=n>Random</span><span class=p>).</span><span class=py>Next</span><span class=p>()</span>    <span class=c># 生成一个随机数, 并赋值给 randint 变量</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$randint</span> <span class=o>-eq</span> <span class=mf>114514</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=s2>&#34;嗯哼哼哼啊啊啊啊啊啊啊啊&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>elseif</span> <span class=p>(</span><span class=nv>$randint</span> <span class=o>-gt</span> <span class=mf>114514</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=s2>&#34;吔屎了你, 梁非凡!&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=s2>&#34;听不见! 就这点声音还想开军舰!?&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>没错, PowerShell 中, &rsquo;else if&rsquo; 的话是不允许带空格的. 并且需要注意的是, 这个大括号不允许省略.</p><h3 id=--循环语句>- 循环语句</h3><p>for 循环</p><blockquote><p><a class=link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_for?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于 For</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=n>exp</span><span class=p>;</span> <span class=n>exp</span><span class=p>;</span> <span class=n>exp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=nv>$i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>1</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nv>$j</span> <span class=p>=</span> <span class=mf>1</span><span class=p>;</span> <span class=nv>$j</span> <span class=o>-le</span> <span class=nv>$i</span><span class=p>;</span> <span class=nv>$j</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>Console</span><span class=p>]::</span><span class=n>Write</span><span class=p>((</span><span class=s2>&#34;{0}x{1}={2}</span><span class=se>`t</span><span class=s2>&#34;</span> <span class=o>-f</span> <span class=p>(</span><span class=nv>$j</span><span class=p>,</span> <span class=nv>$i</span><span class=p>,</span> <span class=nv>$i</span> <span class=p>*</span> <span class=nv>$j</span><span class=p>)))</span>   <span class=c># 不换行输出</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>Console</span><span class=p>]::</span><span class=n>WriteLine</span><span class=p>()</span>    <span class=c># 换行</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>foreach 循环</p><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_foreach target=_blank rel=noopener>MSDocs PowerShell : 关于 Foreach</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$var</span> <span class=k>in</span> <span class=n>enumerable</span> <span class=n>object</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$num</span> <span class=k>in</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.5</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=nv>$num</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>while 循环</p><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_while target=_blank rel=noopener>MSDocs PowerShell : 关于 While</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=n>exp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>打破循环:</p><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_break target=_blank rel=noopener>MSDocs PowerShell : 关于 Break</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># 在 for 中打破循环 :</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>-eq</span> <span class=mf>5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=nv>$i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 在 foreach 语句中打破循环 :</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$i</span> <span class=k>in</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.10</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>-eq</span> <span class=mf>5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=nv>$i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 在 while 语句中打破循环 :</span>
</span></span><span class=line><span class=cl><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=vm>$true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>-eq</span> <span class=mf>5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=nv>$i</span>
</span></span><span class=line><span class=cl>    <span class=nv>$i</span><span class=p>++</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=3-常用类型>3. 常用类型</h2><h3 id=--对象数组>- 对象数组</h3><blockquote><p><a class=link href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于数组</a></p><p><a class=link href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-arrays?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于数组的各项须知内容</a></p></blockquote><p>在 PowerShell 中, 当然也存在数组, 通过以下方式来创建:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># 语法 1:</span>
</span></span><span class=line><span class=cl><span class=nv>$var</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=n>element</span> <span class=mf>1</span><span class=p>,</span> <span class=n>element</span> <span class=mf>2</span><span class=p>,</span> <span class=n>element</span> <span class=mf>3</span><span class=p>,</span> <span class=p>....,</span> <span class=n>element</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c># 示例:</span>
</span></span><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>,</span> <span class=mf>3</span><span class=p>,</span> <span class=mf>4</span><span class=p>,</span> <span class=mf>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 语法 2:</span>
</span></span><span class=line><span class=cl><span class=nv>$var</span> <span class=p>=</span> <span class=n>start</span><span class=p>..</span><span class=k>end</span>
</span></span><span class=line><span class=cl><span class=c># 示例:</span>
</span></span><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.5</span><span class=p>)</span>    <span class=c># 生成的数组等同于: @(1, 2, 3, 4, 5)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 提示, @() 是可以省略的. 不过如果要创建空数组, 不可省略</span>
</span></span></code></pre></td></tr></table></div></div><p>数组的访问, 与其他大多数编程语言一致, 通过中括号就可以:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>echo </span><span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)[</span><span class=mf>2</span><span class=p>]</span>   <span class=c># 输出 3</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$array</span><span class=p>[</span><span class=mf>2</span><span class=p>]</span> <span class=p>=</span> <span class=mf>114514</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array</span><span class=p>[</span><span class=mf>2</span><span class=p>]</span>    <span class=c># 输出 114514</span>
</span></span></code></pre></td></tr></table></div></div><p>PowerShell 的数组还支持获取多个值, 它返回一个新的数组:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$array2</span> <span class=p>=</span> <span class=nv>$array</span><span class=p>[</span><span class=mf>0</span><span class=p>,</span> <span class=mf>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array2</span><span class=p>[</span><span class=mf>0</span><span class=p>]</span>   <span class=c># 输出 1</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array2</span><span class=p>[</span><span class=mf>1</span><span class=p>]</span>   <span class=c># 输出 3</span>
</span></span></code></pre></td></tr></table></div></div><p>添加元素, 可以用 &lsquo;+=&rsquo; 运算符, 但注意, 不推荐这么做, 因为每为数组添加元素, 实际上都是重新创建了新的数组, 如果需要更灵活的数组, 请使用 泛型List</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$array</span> <span class=p>+=</span> <span class=mf>114514</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array</span><span class=p>[</span><span class=mf>4</span><span class=p>]</span>    <span class=c># 输出 114514</span>
</span></span></code></pre></td></tr></table></div></div><p>如果获取数组元素值时, 索引超出界限, 不会抛出异常, 会返回 null:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array</span><span class=p>[</span><span class=mf>114514</span><span class=p>]</span>  <span class=c># 不会有任何输出, 因为值是null</span>
</span></span></code></pre></td></tr></table></div></div><p>如果对一个不是数组的变量使用索引操作符, 则会抛出异常:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$test</span> <span class=p>=</span> <span class=vm>$null</span>
</span></span><span class=line><span class=cl><span class=nv>$test</span><span class=p>[</span><span class=mf>0</span><span class=p>]</span>          <span class=c># 抛出异常</span>
</span></span></code></pre></td></tr></table></div></div><p>两个数组相加, 返回数组连接后的结果:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array1</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$array2</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>3</span><span class=p>.</span><span class=mf>.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=p>(</span><span class=nv>$array1</span> <span class=p>+</span> <span class=nv>$array2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>1
</span></span><span class=line><span class=cl>2
</span></span><span class=line><span class=cl>3
</span></span><span class=line><span class=cl>3
</span></span><span class=line><span class=cl>2
</span></span><span class=line><span class=cl>1
</span></span></code></pre></td></tr></table></div></div><p>使用 -contains 操作符来判断数组是否包含某元素:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=p>(</span><span class=nv>$array</span> <span class=o>-contains</span> <span class=mf>2</span><span class=p>)</span>    <span class=c># 输出 True</span>
</span></span></code></pre></td></tr></table></div></div><p>在 PowerShell 的数组中, -eq 操作符将对所有元素进行判断, 即, 遍历内容, 逐一进行 -eq 运算, 如若有任何元素运算返回 True, 则表达式返回真.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=p>(</span><span class=nv>$array</span> <span class=o>-eq</span> <span class=mf>3</span><span class=p>)</span>          <span class=c># 返回 True</span>
</span></span></code></pre></td></tr></table></div></div><p>如果判断一个变量(可能是数组)为空, 请不要将这个变量放在左侧:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=o>-eq</span> <span class=vm>$null</span>      <span class=c># 不要这样使用</span>
</span></span><span class=line><span class=cl><span class=vm>$null</span> <span class=o>-eq</span> <span class=nv>$array</span>      <span class=c># 正确的使用方式</span>
</span></span></code></pre></td></tr></table></div></div><p>使用 Count 来获取一个数组的长度, 但注意, 如果一个变量值为null, 同样可以使用 count 来获取长度, 它返回 0:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$array</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$array</span><span class=p>.</span><span class=py>Count</span>     <span class=c># 返回 4</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=vm>$null</span><span class=p>.</span><span class=py>Count</span>      <span class=c># 返回 0</span>
</span></span></code></pre></td></tr></table></div></div><p>你也可以通过 Length 来获取一个数组的长度, 它与 Count 用法一样, 并且如果是 $null, 同样返回 0.</p><h3 id=--哈希表>- 哈希表</h3><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables target=_blank rel=noopener>MSDocs PowerShell : 关于哈希表</a></p><p><a class=link href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-hashtable?view=powershell-7.1" target=_blank rel=noopener>MSDocs PowerShell : 关于哈希表的一些注意事项</a></p></blockquote><p>哈希表, 即 HashTable. 在 PowerShell 中这样创建 HashTable:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$table</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=p>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=p>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>            <span class=c># 创建空表</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>             <span class=c># 创建有初始值的表, 下面的示例将使用这个表</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;NullSlime&#34;</span> <span class=p>=</span> <span class=mf>100</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;MoYuro&#34;</span> <span class=p>=</span> <span class=mf>96</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Muchen&#34;</span> <span class=p>=</span> <span class=mf>94</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;KingHans&#34;</span> <span class=p>=</span> <span class=mf>88</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>访问哈希表, 通过索引运算符, 指定键:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># 使用刚刚创建的 table</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$table</span><span class=p>[</span><span class=s2>&#34;MoYuro&#34;</span><span class=p>]</span>    <span class=c># 输出 96</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span><span class=p>[</span><span class=s2>&#34;MoYuro&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=mf>97</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$table</span><span class=p>[</span><span class=s2>&#34;MoYuro&#34;</span><span class=p>]</span>    <span class=c># 输出 97</span>
</span></span></code></pre></td></tr></table></div></div><p>向表中添加键值对, 使用 Add 方法:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$table</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;KunLong&#34;</span><span class=p>,</span> <span class=mf>76</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>删除表中的某个键值对, 使用 Remove 方法:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$table</span><span class=p>.</span><span class=py>Remove</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span><span class=p>.</span><span class=py>Remove</span><span class=p>(</span><span class=s2>&#34;KingHans&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>哈希表和数组一样支持选择多个值, 只需要在索引运算符中指定多个键:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$table</span><span class=p>[</span><span class=no>key1, key2, ... , key n</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span><span class=p>[(</span><span class=n>key1</span><span class=p>,</span> <span class=n>key2</span><span class=p>,</span> <span class=p>...</span> <span class=p>,</span> <span class=n>key</span> <span class=n>n</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=nv>$table</span><span class=p>[</span><span class=vm>@</span><span class=p>(</span><span class=n>key1</span><span class=p>,</span> <span class=n>key2</span><span class=p>,</span> <span class=p>...</span> <span class=p>,</span> <span class=n>key</span> <span class=n>n</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$values</span> <span class=p>=</span> <span class=nv>$table</span><span class=p>[</span><span class=s2>&#34;NullSlime&#34;</span><span class=p>,</span> <span class=s2>&#34;MoYuro&#34;</span><span class=p>]</span>    <span class=c># 返回一个数组</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$values</span><span class=p>[</span><span class=mf>0</span><span class=p>]</span>                            <span class=c># 输出 100</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$values</span><span class=p>[</span><span class=mf>1</span><span class=p>]</span>                            <span class=c># 输出 96</span>
</span></span></code></pre></td></tr></table></div></div><p>通过 Keys 与 Values 来获取这个哈希表的所有键以及值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$keys</span> <span class=p>=</span> <span class=nv>$tables</span><span class=p>.</span><span class=py>Keys</span>          <span class=c># 返回哈希表的所有键</span>
</span></span><span class=line><span class=cl><span class=nv>$values</span> <span class=p>=</span> <span class=nv>$tables</span><span class=p>.</span><span class=py>Values</span>      <span class=c># 返回哈希表的所有值</span>
</span></span></code></pre></td></tr></table></div></div><p>可以通过对哈希表的枚举器来进行循环哈希表的每一个键值对:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$pair</span> <span class=k>in</span> <span class=nv>$table</span><span class=p>.</span><span class=py>GetEnumerator</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=p>(</span><span class=s2>&#34;{0}: {1}&#34;</span> <span class=o>-f</span> <span class=p>(</span><span class=nv>$pair</span><span class=p>.</span><span class=n>Key</span><span class=p>,</span> <span class=nv>$pair</span><span class=p>.</span><span class=n>Value</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>当通过foreach对哈希表进行迭代时, 不可以对哈希表进行删减:</p><h2 id=4-脚本函数>4. 脚本函数</h2><h3 id=--关于函数>- 关于函数</h3><blockquote><p><a class=link href=https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions target=_blank rel=noopener>PowerShell 官方文档 : 关于函数</a></p></blockquote><p>PowerShell 中定义函数很简单, 它的本质是脚本块(ScriptBlock):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>name(parameters</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>statement</span> <span class=n>block</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>myFunc($a</span><span class=p>,</span> <span class=nv>$b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo </span><span class=p>(</span><span class=nv>$a</span> <span class=p>+</span> <span class=nv>$b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>调用 PowerShell 中定义的函数, 语法如下:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>name</span> <span class=n>argv1</span> <span class=n>argv2</span> <span class=n>argv3</span> <span class=p>....</span> <span class=n>argv</span> <span class=n>n</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=n>myFunc</span> <span class=mf>114000</span> <span class=mf>514</span>    <span class=c># 输出 114514</span>
</span></span></code></pre></td></tr></table></div></div><p>如果要获取这个函数的对象引用 可以这样:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$function</span><span class=err>:</span><span class=n>name</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$function</span><span class=err>:</span><span class=n>myFunc</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>param($a, $b)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>echo ($a + $b)
</span></span></code></pre></td></tr></table></div></div><p>通过函数的对象引用, 可以使用 Invoke 来调用:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$function</span><span class=err>:</span><span class=n>name</span><span class=p>.</span><span class=py>Invoke</span><span class=p>(</span><span class=n>parameters</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$function</span><span class=err>:</span><span class=n>myFunc</span><span class=p>.</span><span class=py>Invoke</span><span class=p>(</span><span class=mf>114000</span><span class=p>,</span> <span class=mf>514</span><span class=p>)</span>    <span class=c># 输出 114514</span>
</span></span></code></pre></td></tr></table></div></div><p>删除一个一定义的函数, 可以使用 del 语句:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>del </span><span class=n>function</span><span class=err>:</span><span class=n>name</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nb>del </span><span class=n>function</span><span class=err>:</span><span class=n>myFunc</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$function</span><span class=err>:</span><span class=n>myFunc</span>     <span class=c># 由于函数已删除, 所以不会有任何输出</span>
</span></span></code></pre></td></tr></table></div></div><p>函数可以有返回值, 只需要使用 return 语句:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>myFunc($a</span><span class=p>,</span> <span class=nv>$b</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=nv>$a</span> <span class=p>+</span> <span class=nv>$b</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=p>=</span> <span class=n>myFunc</span> <span class=mf>114000</span> <span class=mf>514</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$result</span>      <span class=c># 输出 114514</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=5-面向对象>5. 面向对象</h2><h3 id=--使用对象>- 使用对象</h3><p>肯定会有人执行这个指令:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>echo </span><span class=n>Hello</span> <span class=n>World</span><span class=p>!</span>
</span></span></code></pre></td></tr></table></div></div><p>虽然仅仅少了一对双引号, 但是, 它表示的意思其实跟之前我们写的完全不一样. 如果不加双引号, 那么在这个指令中, Hello 和 World! 会被认为是两个参数! 或者准确来说, 是两个对象!</p><p>这条没有加双引号的指令, 输出结果是:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>Hello</span>
</span></span><span class=line><span class=cl><span class=n>World</span><span class=p>!</span>
</span></span></code></pre></td></tr></table></div></div><p>另外, 命令的输出同样也是一个个对象, 执行下面的指令:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=mf>1</span><span class=p>+</span><span class=mf>1</span>
</span></span></code></pre></td></tr></table></div></div><p>输出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>2
</span></span></code></pre></td></tr></table></div></div><h3 id=--net-互操作>- .NET 互操作</h3><p>事实上, PowerShell 中的对象都是 .NET 对象. 并且我们可以进行 .NET 对象中所支持的操作. 执行下面的指令:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>(</span><span class=mf>1</span><span class=p>+</span><span class=mf>1</span><span class=p>).</span><span class=py>GetType</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>IsPublic IsSerial Name                                     BaseType
</span></span><span class=line><span class=cl>-------- -------- ----                                     --------
</span></span><span class=line><span class=cl>True     True     Int32                                    System.ValueType
</span></span></code></pre></td></tr></table></div></div><p>这熟悉的命名空间, 可不就是 .NET 吗?</p><p>试试以下指令:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>(</span><span class=nb>echo </span><span class=mf>123</span><span class=p>).</span><span class=py>GetType</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>输出:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>IsPublic IsSerial Name                                     BaseType
</span></span><span class=line><span class=cl>-------- -------- ----                                     --------
</span></span><span class=line><span class=cl>True     True     Int32                                    System.ValueType
</span></span></code></pre></td></tr></table></div></div><p>好家伙, 原来 echo 直接就是把这个对象输出出来对吧!</p><p>而事实上, 一个表达式的运算结果(返回值), 是会打印到控制台的, 这点与 Python 一样.</p><p>所以如果你执行一个 &lsquo;1+1&rsquo;, 这个表达式的运算结果是 2, 则 2 会被打印到控制台.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=mf>1</span><span class=p>+</span><span class=mf>1</span>  <span class=c># 输出 2</span>
</span></span></code></pre></td></tr></table></div></div><p>如果你不希望一个语句的返回值被打印到控制台, 可以在首部添加 [void], 它表示将语句的返回值强制转换为 void 以保证没有输出</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>](</span><span class=mf>1</span><span class=p>+</span><span class=mf>1</span><span class=p>)</span>    <span class=c># 没有输出</span>
</span></span></code></pre></td></tr></table></div></div><p>使用 New-Object 可以创建一个对象, 指定 .NET 对象的全名即可创建:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$random</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Random</span>
</span></span><span class=line><span class=cl><span class=nv>$randint</span> <span class=p>=</span> <span class=nv>$random</span><span class=p>.</span><span class=py>Next</span><span class=p>()</span>    <span class=c># 调用 System.Random 对象的 Next 方法</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$randint</span>                <span class=c># 输出一个随机的数字</span>
</span></span></code></pre></td></tr></table></div></div><p>如果需要带参数的创建 .NET 对象, 直接在 New-Object 语句后添加参数数组即可:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$str</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>String</span> <span class=p>(</span><span class=s1>&#39;草&#39;</span><span class=p>,</span> <span class=mf>20</span><span class=p>)</span>    <span class=c># 生草</span>
</span></span><span class=line><span class=cl><span class=nb>echo </span><span class=nv>$str</span>  <span class=c># 返回 &#39;草草草草草草草草草草草草草草草草草草草草&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>PowerShell 中的强制类型转换是这样使用的:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[</span><span class=n>类型</span><span class=p>]</span><span class=n>对象</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=nv>$numArray</span> <span class=p>=</span> <span class=p>[</span><span class=no>int[]</span><span class=p>](</span><span class=mf>1</span><span class=p>.</span><span class=mf>.4</span><span class=p>)</span>   <span class=c># 将 object[] 转换为 int[]</span>
</span></span></code></pre></td></tr></table></div></div><p>调用 .NET 类的静态方法, 使用下面的语法:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[</span><span class=n>类的全名</span><span class=p>]::</span><span class=n>方法名</span><span class=p>(</span><span class=n>参数</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c># 示例 :</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Console</span><span class=p>]::</span><span class=n>WriteLine</span><span class=p>(</span><span class=s2>&#34;Hello world!&#34;</span><span class=p>)</span>   <span class=c># 输出 Hello world</span>
</span></span></code></pre></td></tr></table></div></div><p>访问字段, 也是一样的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$ansi</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Text.Encoding</span><span class=p>]::</span><span class=k>Default</span>
</span></span></code></pre></td></tr></table></div></div><p>如果要使用某个命名空间, 使用下面的语句:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>using</span> <span class=n>namespace</span> <span class=n>System</span><span class=p>.</span><span class=py>Text</span>
</span></span><span class=line><span class=cl><span class=nv>$ansi</span> <span class=p>=</span> <span class=p>[</span><span class=no>Encoding</span><span class=p>]::</span><span class=k>Default</span>
</span></span></code></pre></td></tr></table></div></div><p>值得高兴的是, 通过调用 .NET 的组件, 你甚至可以在 PowerShell 中创建 UI 窗体, 下面是一个简单的示例代码:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Add-Type</span> <span class=n>-AssemblyName</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span>
</span></span><span class=line><span class=cl><span class=nb>Add-Type</span> <span class=n>-AssemblyName</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$form</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span><span class=p>.</span><span class=py>Form</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Text</span> <span class=p>=</span> <span class=s1>&#39;Select a Computer&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Size</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Size</span><span class=p>(</span><span class=mf>300</span><span class=p>,</span><span class=mf>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>StartPosition</span> <span class=p>=</span> <span class=s1>&#39;CenterScreen&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span><span class=p>.</span><span class=py>Button</span>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span><span class=p>.</span><span class=py>Anchor</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Bottom</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Right</span>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span><span class=p>.</span><span class=py>Location</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Point</span><span class=p>(</span><span class=mf>75</span><span class=p>,</span><span class=mf>120</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span><span class=p>.</span><span class=py>Size</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Size</span><span class=p>(</span><span class=mf>75</span><span class=p>,</span><span class=mf>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span><span class=p>.</span><span class=py>Text</span> <span class=p>=</span> <span class=s1>&#39;OK&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$okButton</span><span class=p>.</span><span class=py>DialogResult</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.DialogResult</span><span class=p>]::</span><span class=n>OK</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>AcceptButton</span> <span class=p>=</span> <span class=nv>$okButton</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Controls</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$okButton</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span><span class=p>.</span><span class=py>Button</span>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span><span class=p>.</span><span class=py>Anchor</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Bottom</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Right</span>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span><span class=p>.</span><span class=py>Location</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Point</span><span class=p>(</span><span class=mf>150</span><span class=p>,</span><span class=mf>120</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span><span class=p>.</span><span class=py>Size</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Size</span><span class=p>(</span><span class=mf>75</span><span class=p>,</span><span class=mf>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span><span class=p>.</span><span class=py>Text</span> <span class=p>=</span> <span class=s1>&#39;Cancel&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$cancelButton</span><span class=p>.</span><span class=py>DialogResult</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.DialogResult</span><span class=p>]::</span><span class=n>Cancel</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>CancelButton</span> <span class=p>=</span> <span class=nv>$cancelButton</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Controls</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$cancelButton</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$label</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span><span class=p>.</span><span class=py>Label</span>
</span></span><span class=line><span class=cl><span class=nv>$label</span><span class=p>.</span><span class=py>Anchor</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Top</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Left</span>
</span></span><span class=line><span class=cl><span class=nv>$label</span><span class=p>.</span><span class=py>Location</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Point</span><span class=p>(</span><span class=mf>10</span><span class=p>,</span><span class=mf>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$label</span><span class=p>.</span><span class=py>Size</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Size</span><span class=p>(</span><span class=mf>280</span><span class=p>,</span><span class=mf>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$label</span><span class=p>.</span><span class=py>Text</span> <span class=p>=</span> <span class=s1>&#39;Please select a computer:&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Controls</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$label</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$listBox</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Windows</span><span class=p>.</span><span class=py>Forms</span><span class=p>.</span><span class=py>ListBox</span>
</span></span><span class=line><span class=cl><span class=nv>$listBox</span><span class=p>.</span><span class=py>Anchor</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Top</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Left</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Bottom</span> <span class=o>-bor</span> <span class=p>[</span><span class=no>System.Windows.Forms.AnchorStyles</span><span class=p>]::</span><span class=n>Right</span>
</span></span><span class=line><span class=cl><span class=nv>$listBox</span><span class=p>.</span><span class=py>Location</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Point</span><span class=p>(</span><span class=mf>10</span><span class=p>,</span><span class=mf>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$listBox</span><span class=p>.</span><span class=py>Size</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Drawing</span><span class=p>.</span><span class=py>Size</span><span class=p>(</span><span class=mf>260</span><span class=p>,</span><span class=mf>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$listBox</span><span class=p>.</span><span class=py>Height</span> <span class=p>=</span> <span class=mf>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-001&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-002&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-003&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-004&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-005&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-006&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>void</span><span class=p>]</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>Items</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s1>&#39;atl-dc-007&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Controls</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$listBox</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$form</span><span class=p>.</span><span class=py>Topmost</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=p>=</span> <span class=nv>$form</span><span class=p>.</span><span class=py>ShowDialog</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$result</span> <span class=o>-eq</span> <span class=p>[</span><span class=no>System.Windows.Forms.DialogResult</span><span class=p>]::</span><span class=n>OK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$x</span> <span class=p>=</span> <span class=nv>$listBox</span><span class=p>.</span><span class=py>SelectedItem</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>System.Windows.Forms.MessageBox</span><span class=p>]::</span><span class=n>Show</span><span class=p>(</span><span class=s2>&#34;你选择了:&#34;</span> <span class=p>+</span> <span class=nv>$x</span><span class=p>.</span><span class=py>ToString</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>System.Windows.Forms.MessageBox</span><span class=p>]::</span><span class=n>Show</span><span class=p>(</span><span class=s2>&#34;你没有选择任何条目&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/powershell/>Powershell</a>
<a href=/tags/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/>脚本语言</a>
<a href=/tags/dotnet/>Dotnet</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/20240117143332/><div class=article-details><h2 class=article-title>[.NET] 查询当前已安装所有 Win32 与 UWP 应用</h2></div></a></article><article><a href=/p/20231208192209/><div class=article-details><h2 class=article-title>[C#] 基于 yield 语句的迭代器逻辑懒执行</h2></div></a></article><article><a href=/p/20231113094519/><div class=article-details><h2 class=article-title>[.NET] Speex 语音编解码介绍, 使用, 代码示例</h2></div></a></article><article><a href=/p/20230902085924/><div class=article-details><h2 class=article-title>[.NET/WPF] 设置按钮, 以及其他任何包含边框的控件的圆角</h2></div></a></article><article><a href=/p/20230818143649/><div class=article-details><h2 class=article-title>[.NET/WPF] CommunityToolkit.Mvvm 异步指令</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=SlimeNull/slimenull.github.io issue-term=pathname label=BlogComment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 SlimeNull Blogs</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>