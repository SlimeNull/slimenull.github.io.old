<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mci on SlimeNull Blogs</title><link>https://slimenull.com/tags/mci/</link><description>Recent content in Mci on SlimeNull Blogs</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Thu, 11 Feb 2021 10:21:11 +0800</lastBuildDate><atom:link href="https://slimenull.com/tags/mci/index.xml" rel="self" type="application/rss+xml"/><item><title>[C#] MCI 详解与封装类, MCI 播放音乐, 获取播放状态, 获取音频长度, 进度调整,</title><link>https://slimenull.com/p/20210211102111/</link><pubDate>Thu, 11 Feb 2021 10:21:11 +0800</pubDate><guid>https://slimenull.com/p/20210211102111/</guid><description>&lt;h2 id="淦">淦!&lt;/h2>
&lt;p>琢磨了一晚上啊, 总算有些眉目了. &lt;sub>(所以我还是一个笨蛋啊, 明明这么简单的东西却花费了这么长时间&lt;/sub>&lt;/p>
&lt;p>首先, MCI的全称是Multimedia Control Interface, 即多媒体控制接口, 通过它, 我们可以做到播放音频视频, 甚至录制音频, 虽然古老, 但是真的强大.&lt;/p>
&lt;p>注意, 文章较官方文档有不少删减, 如果看标准内容, 还是看官方文档比较好.&lt;/p>
&lt;blockquote>
&lt;p>MCI Command Strings 官方文档: &lt;a class="link" href="https://docs.microsoft.com/en-us/windows/win32/multimedia/mci-command-strings" target="_blank" rel="noopener"
>Microsoft Command Strings - Win32 app | Microsoft Docs&lt;/a>
哦对了, 文档是纯英文哦~&lt;/p>
&lt;/blockquote>
&lt;h2 id="理论基础">理论基础:&lt;/h2>
&lt;ol>
&lt;li>MCI 不能与 C# 中的内存流打交道, 他只能播放文件.&lt;/li>
&lt;li>MCI 支持很多格式, 包含: CD音频, 数字音频, MIDI音乐, 视频唱片(videodisc), VCR, 以及波形音频.&lt;/li>
&lt;li>MCI 中, 被播放的音频文件被称作 &lt;strong>设备(Device)&lt;/strong>&lt;/li>
&lt;li>MCI 中, 支持巨多设置项, 包括播放进度, 音量大小, 声道开关, 如果你播放的是 MIDI, 支持的设置更多.&lt;/li>
&lt;/ol>
&lt;h2 id="正式开始">正式开始:&lt;/h2>
&lt;p>下面, 我们将以播放音频为例, 尽可能多的讲述 MCI 的相关知识, 文章在今后可能会继续更新.&lt;/p>
&lt;p>示例文件在: C:\Users\Null\Desktop\Tutorial.wav&lt;/p>
&lt;h4 id="-引用库">&amp;gt; 引用库:&lt;/h4>
&lt;ul>
&lt;li>最最开始, 无非是载入库.&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>对于 C++, 需要引用 Windows.h 以及 Mmsystem.h 这两个头文件&lt;/li>
&lt;li>对于 C#, using System.Runtime.InteropServices; 以进行非托管库的调用.&lt;/li>
&lt;/ol>
&lt;h4 id="-执行指令">&amp;gt; 执行指令:&lt;/h4>
&lt;ul>
&lt;li>MCI 中, 有 3 种方式来执行 MCI 指令. 分别是: mciSendString, mciExecute, mciSendCommand, 它们均位于 winmm.dll 中.&lt;/li>
&lt;/ul>
&lt;h1 id="heading">&lt;/h1>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>函数原型:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">MCIERROR&lt;/span> &lt;span class="nf">mciSendString&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="c1">// MCIERROR 是 无符号长整形数字
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">LPCTSTR&lt;/span> &lt;span class="n">lpszCommand&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LPTSTR&lt;/span> &lt;span class="n">lpszReturnString&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">UINT&lt;/span> &lt;span class="n">cchReturn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">HANDLE&lt;/span> &lt;span class="n">hwndCallback&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BOOL&lt;/span> &lt;span class="nf">mciExecute&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LPCSTR&lt;/span> &lt;span class="n">pszCommand&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">MCIERROR&lt;/span> &lt;span class="nf">mciSendCommand&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">MCIDEVICEID&lt;/span> &lt;span class="n">IDDevice&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// 设备 ID, 通过另一个函数打开文件可以获得
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">UINT&lt;/span> &lt;span class="n">uMsg&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DWORD_PTR&lt;/span> &lt;span class="n">fdwCommand&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DWORD_PTR&lt;/span> &lt;span class="n">dwParam&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>C# 声明方式:&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="na">[DllImport(&amp;#34;winmm.dll&amp;#34;, EntryPoint = &amp;#34;mciSendString&amp;#34;, CharSet = CharSet.Unicode)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">extern&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">ulong&lt;/span> &lt;span class="n">MciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">command&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">bufferSize&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span> &lt;span class="n">callback&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">[DllImport(&amp;#34;winmm.dll&amp;#34;, EntryPoint = &amp;#34;mciExecute&amp;#34;, CharSet = CharSet.Unicode)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">extern&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="n">MciExecute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">command&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">[DllImport(&amp;#34;winmm.dll&amp;#34;, EntryPoint = &amp;#34;mciSendCommand&amp;#34;, CharSet = CharSet.Unicode)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">extern&lt;/span> &lt;span class="kd">static&lt;/span> &lt;span class="kt">ulong&lt;/span> &lt;span class="n">MciSendCommand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">uint&lt;/span> &lt;span class="n">deviceId&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">uint&lt;/span> &lt;span class="n">uMsg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span> &lt;span class="n">fdwCommand&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span> &lt;span class="n">dwParam&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>简略说明:&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>mciSendString: 最常用的方法, 通过字符串来表示一个指令, 会返回错误码, 不会有弹窗警告
mciExecute: 调试时较常用的方法, 在执行时若有未完善的地方, 会弹窗警告, 也因为如此, 程序的发布版本不会使用这个(影响使用体验)
mciSendCommand: 很少用, 通过指令的ID来表示指令, 会返回错误码, 不会有弹窗警告
 
某些 MCI 指令具有返回值, 例如获取播放状态, 这些指令不能通过mciExecute执行.&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h1 id="heading-1">&lt;/h1>
&lt;ul>
&lt;li>文章只会通过 mciSendString 来介绍 MCI 哟&lt;/li>
&lt;/ul>
&lt;h4 id="-打开文件">&amp;gt; 打开文件:&lt;/h4>
&lt;ul>
&lt;li>对于播放音频, 首要的第一件事, 肯定就是打开文件并将其载入到内存了. 不过有一点很重要, 就是 MCI 指令只支持短路径(ShortPath), 所以在拿到文件路径后, 我们得将其转换为短路径.&lt;/li>
&lt;li>如果不对路径进行转换, 那么某些名字长度大于8的文件(准确来说是路径中任何一部分长度大于8)的将无法播放
&lt;blockquote>
&lt;p>关于短路径与长路径: &lt;a class="link" href="https://blog.csdn.net/zfs2008zfs/article/details/51154873" target="_blank" rel="noopener"
>windows系统下的文件长名和文件短名&lt;/a>
短路径与长路径的转换: &lt;a class="link" href="https://slimenull.com/p/20210209080535/" >[C#/C/C++] GetShortPathName 详解, 长路径转换为短路径&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>MCI 指令中, 通过 open 来打开一个文件, 并且在末尾还可以使用 &amp;ldquo;alias 别名&amp;rdquo; 来为这个已打开的文件起一个别名.&lt;/li>
&lt;li>下面是两个示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 文件是 C:\Users\Null\Desktop\Tutorial.wav&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 转换为短路径是 C:\Users\Null\Desktop\Tut~1.wav&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;open C:\Users\Null\Desktop\Tut~1.wav&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;open C:\Users\Null\Desktop\Tut~1.wav alias tutorial&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>在第一的 mciSendString 中, 很清晰明了, 打开了一个文件, 而第二个中, 我们还加了一个alias, 即, 别名, MCI支持为打开的文件起一个别名, 并且推荐这么做.
第二个种, 我们为它起的别名是 tutorial.&lt;/li>
&lt;/ul>
&lt;h4 id="-播放音频">&amp;gt; 播放音频:&lt;/h4>
&lt;ul>
&lt;li>播放音频的 MCI 指令是 play, 直接 &amp;ldquo;play 设备&amp;rdquo;&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play C:\Users\Null\Desktop\Tut~1.wav&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play tutorial&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>如果你没有为文件指定别名, 那么在使用 play 指令时, 只能指定短路径
如果你为文件指定了别名, 直接play加上别名即可播放这个文件.&lt;/li>
&lt;/ul>
&lt;h4 id="-重复播放音频">&amp;gt; 重复播放音频:&lt;/h4>
&lt;ul>
&lt;li>这里, 用到了参数, 就像alias一样, 可选. 重复播放还是使用的play指令.&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play C:\Users\Null\Desktop\Tut~1.wav repeat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play tutorial repeat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>设备名如旧, 可以直接指定短路径, 也可以指定别名, 而想做到重复播放, 只需要在最后指定repeat&lt;/li>
&lt;/ul>
&lt;h4 id="-同步播放音频">&amp;gt; 同步播放音频:&lt;/h4>
&lt;ul>
&lt;li>同样是参数, 这里是wait, 支持wait参数的指令可以同步执行, 例如play指令&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play C:\Users\Null\Desktop\Tut~1.wav wait&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;play tutorial wait&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>执行后, 将会阻塞当前现成, 直至播放结束.&lt;/li>
&lt;/ul>
&lt;h4 id="-暂停播放">&amp;gt; 暂停播放:&lt;/h4>
&lt;ul>
&lt;li>暂停, pause, 用法很简单, 同样是 &amp;ldquo;pause 设备&amp;rdquo;&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;pause C:\Users\Null\Desktop\Tut~1.wav&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;pause tutorial&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>执行后, 正在播放的音频就会暂停.&lt;/li>
&lt;/ul>
&lt;h4 id="-恢复播放">&amp;gt; 恢复播放:&lt;/h4>
&lt;ul>
&lt;li>恢复, resume, 语法是 &amp;ldquo;resume 设备&amp;rdquo;&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;pause C:\Users\Null\Desktop\Tut~1.wav&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;pause tutorial&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>执行后, 暂停播放的音频就会恢复.&lt;/li>
&lt;/ul>
&lt;h4 id="-关闭文件">&amp;gt; 关闭文件:&lt;/h4>
&lt;ul>
&lt;li>关闭, close, 语法是: &amp;ldquo;close 设备&amp;rdquo;&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;close C:\Users\Null\Desktop\Tut~1.wav&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;close tutorial&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>执行后, 文件会被关闭. 如果音频正在播放, 则会停止.&lt;/li>
&lt;/ul>
&lt;h4 id="-改变播放位置">&amp;gt; 改变播放位置:&lt;/h4>
&lt;ul>
&lt;li>seek 指令, 这个指令比较复杂哦. 语法如下:
&lt;blockquote>
&lt;p>seek &lt;em>device&lt;/em> to &lt;em>position&lt;/em>
seek &lt;em>device&lt;/em> to start
seek &lt;em>device&lt;/em> to end&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>示例:
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;seek tutorial to 1000&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;seek tutorial to start&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">@&amp;#34;seek tutorial to end&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>短路径肯定是能用的哦, 我只是懒得写了, 至于 &amp;ldquo;seek &lt;em>device&lt;/em> to &lt;em>position&lt;/em>&amp;rdquo; 的用法, 其中position默认是ms为单位的整数时间哦, 也就是说, 1000代表1s.&lt;/li>
&lt;li>seek 的单位是可以调整的, 继续看哦&lt;/li>
&lt;/ul>
&lt;h4 id="-设置相关">&amp;gt; 设置相关:&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>设置, set, 这个支持的就更多了&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>以下是适用于 CD Audio 的语法 :&lt;/strong>
set &lt;em>device&lt;/em> time format milliseconds
set &lt;em>device&lt;/em> time format msf
set &lt;em>device&lt;/em> time format tmsf&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>&lt;strong>以下是适用于 Wave Audio 的语法 :&lt;/strong>
set &lt;em>device&lt;/em> any input
set &lt;em>device&lt;/em> any output
set &lt;em>device&lt;/em> channels &lt;em>channel_count&lt;/em>
set &lt;em>device&lt;/em> format tag pcm
set &lt;em>device&lt;/em> format tag tag
set &lt;em>device&lt;/em> input &lt;em>integer&lt;/em>
set &lt;em>device&lt;/em> output &lt;em>integer&lt;/em>
set &lt;em>device&lt;/em> time format bytes
set &lt;em>device&lt;/em> time format milliseconds&lt;/p>
&lt;/blockquote>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>选项&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>time format milliseconds&lt;/td>
&lt;td>将时间格式设置为毫秒, 所有使用position值的指令都将采用毫秒作为单位, 你可以将milliseconds缩写为ms. 对于音序器设备,&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>time format msf&lt;/td>
&lt;td>设置时间格式到 分钟, 妙, 以及帧. 所有使用position值的指令都见采用MSF格式(CD音频的默认格式), 请将MSF值指定为 mm:ss:ff 的格式, mm是分钟, ss是秒, ff是帧. 如果一个字段以及后面的字段都是0, 你可以忽略掉它. 例如, 3, 3:0, 3:0:0 都是表示3分钟的正确方式. MSF字段有以下最大值, 分钟:99, 秒:59, 帧: 74.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>time format tmsf&lt;/td>
&lt;td>将时间格式设置为 音轨, 分钟, 秒, 以及帧. 所有使用position值的指令都见采用TMSF格式, 额, 与上面的一样, 只不过多了个音轨. 音轨的最大值是99, 分钟, 秒, 帧的最大值与MSF格式一致.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>any input&lt;/td>
&lt;td>当录制时, 使用所有支持当前格式的输入, 这是默认设置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>any output&lt;/td>
&lt;td>当播放时, 使用所有支持当前格式的输出, 这是默认的&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>time format bytes&lt;/td>
&lt;td>在 PCM 文件格式中, 设置时间格式(单位)为字节, 指定这个指令后, 所有position信息都将被指定为字节格式&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/li>
&lt;/ul>
&lt;h4 id="-状态信息">&amp;gt; 状态信息:&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>状态, status, 语法: &amp;ldquo;status &lt;em>device&lt;/em> &lt;em>option&lt;/em>&amp;rdquo;, 返回到 mciSendString 参数指定的字符串缓冲区&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>适用于音频的常用语法&lt;/strong>&lt;/p>
&lt;p>status &lt;em>device&lt;/em> position&lt;/p>
&lt;p>status &lt;em>device&lt;/em> length&lt;/p>
&lt;p>status &lt;em>device&lt;/em> mode&lt;/p>
&lt;p>status &lt;em>device&lt;/em> time format&lt;/p>
&lt;/blockquote>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>选项&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>position&lt;/td>
&lt;td>获取目前播放的位置单位与时间格式统一&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>length&lt;/td>
&lt;td>获取当前播放音频的长度 单位与时间格式统一&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mode&lt;/td>
&lt;td>获取播放状态, 返回的值是以下值之一: stopped / playing / paused&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>time format&lt;/td>
&lt;td>获取当前的时间格式&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">string&lt;/span> &lt;span class="n">buffer&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">256&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// 分配一个长度的字符串用来存放返回值&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mciSendString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;status tutorial position&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">256&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">IntPtr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Zero&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// 调用&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TrimEnd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// 打印返回值, TrimEnd的原因字符串的是长度是256, 函数没有使用的部分仍然是 \0 字符.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="-音频设置">&amp;gt; 音频设置&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>设置音频, setaudio, 语法 &amp;ldquo;setaudio &lt;em>device&lt;/em> &lt;em>option&lt;/em>&amp;rdquo;&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>常用语法:&lt;/strong>&lt;/p>
&lt;p>setaudio &lt;em>device&lt;/em> left volume to &lt;em>factor&lt;/em>&lt;/p>
&lt;p>setaudio &lt;em>device&lt;/em> right volume to &lt;em>factor&lt;/em>&lt;/p>
&lt;p>setaudio &lt;em>device&lt;/em> volume to &lt;em>factor&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>选项&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>left/right volume to &lt;em>factor&lt;/em>&lt;/td>
&lt;td>将指定声道的音量设置为指定值&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>volume to &lt;em>factor&lt;/em>&lt;/td>
&lt;td>将音量设置为指定值&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/li>
&lt;/ul>
&lt;h2 id="错误码">错误码:&lt;/h2>
&lt;ul>
&lt;li>下面是sendMciString会返回的错误码以及描述(对名称翻译, 然后稍加校正), 哦对了, 返回 0 代表无错误哦
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>错误码&lt;/th>
&lt;th>名称&lt;/th>
&lt;th>描述&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>257&lt;/td>
&lt;td>MCIERR_INVALID_DEVICE_ID&lt;/td>
&lt;td>无效设备 ID&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>259&lt;/td>
&lt;td>MCIERR_UNRECOGNIZED_KEYWORD&lt;/td>
&lt;td>未识别关键字&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>261&lt;/td>
&lt;td>MCIERR_UNRECOGNIZED_COMMAND&lt;/td>
&lt;td>未识别的命令&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>262&lt;/td>
&lt;td>MCIERR_HARDWARE&lt;/td>
&lt;td>硬件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>263&lt;/td>
&lt;td>MCIERR_INVALID_DEVICE_NAME&lt;/td>
&lt;td>无效的设备名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>264&lt;/td>
&lt;td>MCIERR_OUT_OF_MEMORY&lt;/td>
&lt;td>内存不足&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>265&lt;/td>
&lt;td>MCIERR_DEVICE_OPEN&lt;/td>
&lt;td>设备打开&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>266&lt;/td>
&lt;td>MCIERR_CANNOT_LOAD_DRIVER&lt;/td>
&lt;td>无法加载驱动程序&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>267&lt;/td>
&lt;td>MCIERR_MISSING_COMMAND_STRING&lt;/td>
&lt;td>缺少命令字符串&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>268&lt;/td>
&lt;td>MCIERR_PARAM_OVERFLOW&lt;/td>
&lt;td>参数溢出&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>269&lt;/td>
&lt;td>MCIERR_MISSING_STRING_ARGUMENT&lt;/td>
&lt;td>缺少字符串参数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>270&lt;/td>
&lt;td>MCIERR_BAD_INTEGER&lt;/td>
&lt;td>坏整数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>271&lt;/td>
&lt;td>MCIERR_PARSER_INTERNAL&lt;/td>
&lt;td>分析器内部 (估计是这个API内部对指令分析时出现的错误)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>272&lt;/td>
&lt;td>MCIERR_DRIVER_INTERNAL&lt;/td>
&lt;td>驱动程序内部&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>273&lt;/td>
&lt;td>MCIERR_MISSING_PARAMETER&lt;/td>
&lt;td>缺少参数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>274&lt;/td>
&lt;td>MCIERR_UNSUPPORTED_FUNCTION&lt;/td>
&lt;td>不支持的功能&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>275&lt;/td>
&lt;td>MCIERR_FILE_NOT_FOUND&lt;/td>
&lt;td>未找到文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>276&lt;/td>
&lt;td>MCIERR_DEVICE_NOT_READY&lt;/td>
&lt;td>设备未就绪&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>277&lt;/td>
&lt;td>MCIERR_INTERNAL&lt;/td>
&lt;td>内部&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>278&lt;/td>
&lt;td>MCIERR_DRIVER&lt;/td>
&lt;td>驱动器&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>279&lt;/td>
&lt;td>MCIERR_CANNOT_USE_ALL&lt;/td>
&lt;td>不能全部使用&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>280&lt;/td>
&lt;td>MCIERR_MULTIPLE&lt;/td>
&lt;td>多个&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>281&lt;/td>
&lt;td>MCIERR_EXTENSION_NOT_FOUND&lt;/td>
&lt;td>未找到扩展&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>282&lt;/td>
&lt;td>MCIERR_OUTOFRANGE&lt;/td>
&lt;td>超出范围&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>284&lt;/td>
&lt;td>MCIERR_FLAGS_NOT_COMPATIBLE&lt;/td>
&lt;td>标志不兼容&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>286&lt;/td>
&lt;td>MCIERR_FILE_NOT_SAVED&lt;/td>
&lt;td>文件未保存&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>287&lt;/td>
&lt;td>MCIERR_DEVICE_TYPE_REQUIRED&lt;/td>
&lt;td>需要设备类型&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>288&lt;/td>
&lt;td>MCIERR_DEVICE_LOCKED&lt;/td>
&lt;td>设备已锁定&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>289&lt;/td>
&lt;td>MCIERR_DUPLICATE_ALIAS&lt;/td>
&lt;td>重复别名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>290&lt;/td>
&lt;td>MCIERR_BAD_CONSTANT&lt;/td>
&lt;td>坏常量&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>291&lt;/td>
&lt;td>MCIERR_MUST_USE_SHAREABLE&lt;/td>
&lt;td>必须使用可共享&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>292&lt;/td>
&lt;td>MCIERR_MISSING_DEVICE_NAME&lt;/td>
&lt;td>缺少设备名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>293&lt;/td>
&lt;td>MCIERR_BAD_TIME_FORMAT&lt;/td>
&lt;td>错误的时间格式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>294&lt;/td>
&lt;td>MCIERR_NO_CLOSING_QUOTE&lt;/td>
&lt;td>没有关闭中的引用&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>295&lt;/td>
&lt;td>MCIERR_DUPLICATE_FLAGS&lt;/td>
&lt;td>重复标志&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>296&lt;/td>
&lt;td>MCIERR_INVALID_FILE&lt;/td>
&lt;td>无效文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>297&lt;/td>
&lt;td>MCIERR_NULL_PARAMETER_BLOCK&lt;/td>
&lt;td>空参数块&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>298&lt;/td>
&lt;td>MCIERR_UNNAMED_RESOURCE&lt;/td>
&lt;td>未命名的资源&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>299&lt;/td>
&lt;td>MCIERR_NEW_REQUIRES_ALIAS&lt;/td>
&lt;td>新需要别名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>300&lt;/td>
&lt;td>MCIERR_NOTIFY_ON_AUTO_OPEN&lt;/td>
&lt;td>自动打开时通知&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>301&lt;/td>
&lt;td>MCIERR_NO_ELEMENT_ALLOWED&lt;/td>
&lt;td>不允许任何元素&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>302&lt;/td>
&lt;td>MCIERR_NONAPPLICABLE_FUNCTION&lt;/td>
&lt;td>不可应用功能&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>303&lt;/td>
&lt;td>MCIERR_ILLEGAL_FOR_AUTO_OPEN&lt;/td>
&lt;td>非法自动打开&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>304&lt;/td>
&lt;td>MCIERR_FILENAME_REQUIRED&lt;/td>
&lt;td>需要文件名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>305&lt;/td>
&lt;td>MCIERR_EXTRA_CHARACTERS&lt;/td>
&lt;td>额外字符 (可能是指多出了一些不需要的字符)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>306&lt;/td>
&lt;td>MCIERR_DEVICE_NOT_INSTALLED&lt;/td>
&lt;td>未安装设备&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>307&lt;/td>
&lt;td>MCIERR_GET_CD&lt;/td>
&lt;td>获取 CD&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>308&lt;/td>
&lt;td>MCIERR_SET_CD&lt;/td>
&lt;td>设置 CD&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>309&lt;/td>
&lt;td>MCIERR_SET_DRIVE&lt;/td>
&lt;td>设置驱动器&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>310&lt;/td>
&lt;td>MCIERR_DEVICE_LENGTH&lt;/td>
&lt;td>设备长度&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>311&lt;/td>
&lt;td>MCIERR_DEVICE_ORD_LENGTH&lt;/td>
&lt;td>设备 ORD 长度&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>312&lt;/td>
&lt;td>MCIERR_NO_INTEGER&lt;/td>
&lt;td>无整数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>320&lt;/td>
&lt;td>MCIERR_WAVE_OUTPUTSINUSE&lt;/td>
&lt;td>波输出&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>321&lt;/td>
&lt;td>MCIERR_WAVE_SETOUTPUTINUSE&lt;/td>
&lt;td>波设置输出&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>322&lt;/td>
&lt;td>MCIERR_WAVE_INPUTSINUSE&lt;/td>
&lt;td>波输入使用&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>323&lt;/td>
&lt;td>MCIERR_WAVE_SETINPUTINUSE&lt;/td>
&lt;td>波设置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>324&lt;/td>
&lt;td>MCIERR_WAVE_OUTPUTUNSPECIFIED&lt;/td>
&lt;td>波输出未指定&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>325&lt;/td>
&lt;td>MCIERR_WAVE_INPUTUNSPECIFIED&lt;/td>
&lt;td>波输入未指定&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>326&lt;/td>
&lt;td>MCIERR_WAVE_OUTPUTSUNSUITABLE&lt;/td>
&lt;td>波输出可居住&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>327&lt;/td>
&lt;td>MCIERR_WAVE_SETOUTPUTUNSUITABLE&lt;/td>
&lt;td>波设置通普通西装&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>328&lt;/td>
&lt;td>MCIERR_WAVE_INPUTSUNSUITABLE&lt;/td>
&lt;td>波输入可居住&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>329&lt;/td>
&lt;td>MCIERR_WAVE_SETINPUTUNSUITABLE&lt;/td>
&lt;td>波设置通图适合&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>336&lt;/td>
&lt;td>MCIERR_SEQ_DIV_INCOMPATIBLE&lt;/td>
&lt;td>Seq Div 不兼容&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>337&lt;/td>
&lt;td>MCIERR_SEQ_PORT_INUSE&lt;/td>
&lt;td>SEQ 端口 INUSE&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>338&lt;/td>
&lt;td>MCIERR_SEQ_PORT_NONEXISTENT&lt;/td>
&lt;td>Seq 端口不存在&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>339&lt;/td>
&lt;td>MCIERR_SEQ_PORT_MAPNODEVICE&lt;/td>
&lt;td>Seq 端口地图无设备&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>340&lt;/td>
&lt;td>MCIERR_SEQ_PORT_MISCERROR&lt;/td>
&lt;td>SEQ 杂项错误&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>341&lt;/td>
&lt;td>MCIERR_SEQ_TIMER&lt;/td>
&lt;td>SEQ 定时器&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>342&lt;/td>
&lt;td>MCIERR_SEQ_PORTUNSPECIFIED&lt;/td>
&lt;td>SEQ 端口未指定&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>343&lt;/td>
&lt;td>MCIERR_SEQ_NOMIDIPRESENT&lt;/td>
&lt;td>SEQ 没有MIDI在场&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>346&lt;/td>
&lt;td>MCIERR_NO_WINDOW&lt;/td>
&lt;td>无窗口&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>347&lt;/td>
&lt;td>MCIERR_CREATEWINDOW&lt;/td>
&lt;td>创建窗口&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>348&lt;/td>
&lt;td>MCIERR_FILE_READ&lt;/td>
&lt;td>文件读取&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>349&lt;/td>
&lt;td>MCIERR_FILE_WRITE&lt;/td>
&lt;td>文件写入&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>350&lt;/td>
&lt;td>MCIERR_NO_IDENTITY&lt;/td>
&lt;td>无标识&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/li>
&lt;/ul>
&lt;h2 id="封装类">封装类:&lt;/h2>
&lt;blockquote>
&lt;p>去这里吧, 在我的另一篇文章中 &lt;a class="link" href="https://slimenull.com/p/20210211104239/" >[C#] 音乐播放 3 种方式 Demo 与 MCI 音乐播放器封装类.&lt;/a> o(〃&amp;rsquo;▽&amp;rsquo;〃)o&lt;/p>
&lt;/blockquote>
&lt;h2 id="附加内容">附加内容:&lt;/h2>
&lt;ul>
&lt;li>下面是我的一些发现
&lt;blockquote>
&lt;ol>
&lt;li>WinForm 程序使用 MCI 是可以打开 MP3 文件的, 但是如果是控制台程序, 就会出现错误, 错误码266, &amp;ldquo;MCIERR_CANNOT_LOAD_DRIVER&amp;rdquo;&lt;/li>
&lt;li>MCI 的某些指令不能正常使用, 但其实并不是很影响, 例如, &amp;ldquo;set &lt;em>device&lt;/em> audio &lt;em>left/right&lt;/em> &lt;em>off/off&lt;/em>&amp;rdquo;, 无法正常使用.&lt;/li>
&lt;li>音量控制我目前还是没弄成&amp;hellip; 不过可以确认的是, 进度获取, 调整, 长度获取是没问题的, 有这些最基本的, 就差不多公用了呢&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;p>放一张我写文章时的照片吧 , 原文贴的哪都是 (笑&lt;/p>
&lt;p>&lt;img src="https://slimenull.com/images/20210209110959116.png"
loading="lazy"
alt="手动翻译, 淦"
>&lt;/p></description></item></channel></rss>